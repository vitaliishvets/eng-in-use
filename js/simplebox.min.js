var simplebox=function(){var e,t,i,n,o,l,a,d,h,r,s,p,c,f,u,g,m=null,y=!1,v=1,w=20,x=new Image,b={style:{}},B=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,C=/[^\.]\.(swf)\s*$/i,k=[],M={padding:10,margin:20,width:560,height:340,cyclic:!1,overlayShow:!0,hideOnOverlayClick:!0,hideOnContentClick:!1,swf:{wmode:"opaque"},h5video:{controls:"controls",preload:"metadata",autoplay:!1},flashPlayer:"http://releases.flowplayer.org/swf/flowplayer-3.2.1.swf",titlePosition:"inside",titleShow:!0,titleFormat:null,transitionIn:"fade",transitionOut:"fade",speedIn:500,speedOut:500,changeSpeed:500,changeFade:500,scrolling:"auto",autoScale:!0,autoDimension:!0,enableCenter:!0,enableMouseWheel:!0,showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,overlayColor:"#666",overlayOpacity:"0.3",preloadIndent:1};function E(){o.style.display="none",x.onerror=x.onload=null}function S(){y||(y=!0,E(),y=!1)}function I(){simplebox.start({content:"Sorry! the request cann't be reached"},{transitionIn:"none",transitionOut:"none"})}function O(){var o,h=function(){n.innerHTML=t.innerHTML="",Box.fadeOut(e,"fast",function(){y=!1})};y||(y=!0,E(),Box.removeEvent(document,"keydown",q),Box.removeEvent(window,"resize",W),l.style.display="none",a.style.display="none",d.style.display="none",n.style.overflow="hidden",m&&(m.parentNode.removeChild(m),m=null),"fade"==p.transitionOut?Box.fadeOut(i,h):"elastic"==p.transitionOut?(o=u,u=f,f=o,new Animate(b,"fx",{from:0,to:1,step:L,time:p.speedOut,callback:function(){i.style.display="none",h()}})):(i.style.display="none",h()))}function H(){if(!y){y=!0,E(),p=Box.extend({},s);var e,i,n,l,a=h[r],d=p.orig;if("string"==typeof d&&(d=document.querySelector(d)),a.getElementsByTagName&&!d&&(p.orig=d=a.getElementsByTagName("img")[0]),p.title=a.title||d&&(d.title||d.alt)||"",e=p.href||a.href||null,p.type)"html"==(i=p.type)&&(e=p.content);else if(e&&(e.match(B)?i="image":e.match(C)&&(i="swf")),void 0!==p.content)i="html",e=p.content;else if((n=p.video)&&(l=n.split(";"))&&l.length>0){var f,u={mp4:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',webm:'video/webm; codecs="vp8, vorbis"',ogv:'video/ogg; codecs="theora, vorbis"',ogg:'video/ogg; codecs="theora, vorbis"'},g=[],m=null;i="h5video",f=document.createElement("video"),document.body.appendChild(f),l.forEach(function(e,t,i){var o,l=e.slice(-3);if("flv"!=l&&(n=u[l])){if("mp4"==l&&(g.push(e),!f.play))return void g.push(e);"probably"!=(o=f.canPlayType(n))&&"maybe"!=o||m||(m='<source src="'+e+"\" type='"+n+"'>")}else g.push(e)}),g.length>0&&(e=g[0]),m&&(e=m)}if(e&&i){p.href=e,p.type=i;var v,w="",b="";switch(i){case"image":y=!1,clearInterval(c),o.style.display="block",c=setInterval($,66),(x=new Image).onload=function(){x.onerror=null,x.onload=null,y=!0,t.innerHTML="",p.width=x.width,p.height=x.height,x.alt=p.title,x.id="simple-img",t.appendChild(x),T()},x.onerror=I,x.src=e;break;case"h5video":if(f.play&&m){for(v in w+='<video id="simple-video" ',p.h5video)w+=v+"="+p.h5video[v]+" ";w+='width="'+p.width+'" height="'+p.height+'">',w+=m,w+="</video>",t.innerHTML=w,document.body.removeChild(f),T();break}g.length>0&&(document.body.removeChild(f),p.swf.flashvars=function(){var e,t,i={};return t=i.playlist=[],(e=p.h5video.poster)&&t.push(e),(e={}).url=p.href,e.autoPlay=p.h5video.autoplay,e.autoBuffering="none"!==p.h5video.preload,t.push(e),"config="+JSON.stringify(i)}(),p.href=p.flashPlayer);case"swf":for(v in w+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="'+p.width+'" height="'+p.height+'"><param name="movie" value="'+p.href+'"></param>',p.swf)w+='<param name="'+v+"\" value='"+p.swf[v]+"'></param>",b+=" "+v+"='"+p.swf[v]+"'";w+='<embed src="'+p.href+'" type="application/x-shockwave-flash" width="'+p.width+'" height="'+p.height+'"'+b+"></embed></object>",t.innerHTML=w,T();break;case"html":t.innerHTML=p.href,p.autoDimension&&(Box.extend(t.style,{display:"block",position:"absolute"}),p.width=parseInt(Box.getComputedStyleValue(t,"width")),p.height=parseInt(Box.getComputedStyleValue(t,"height")),Box.extend(t.style,{display:"none",position:"auto"})),T()}}else y=!1}}function T(){var s,c,y,v=p.fadeSpeed;if(o.style.display="none",y=Box.extend({},u),u=P(),function(){var e,t=p.title,n=p.padding;m&&(m.parentNode.removeChild(m),m=null);if(g=0,!p.titleShow)return;if(!t)return;switch(t="function"==typeof p.titleFormat?p.titleFormat(t,h,r,p):function(e){var t=!1;if(e&&e.length)switch(p.titlePosition){case"over":t='<span id="simple-title-over">'+e+"</span>";break;default:t=e}return t}(t),e=Math.max(u.width-2*n,1),m=Box.createElement("div",{id:"simple-title",innerHTML:t,className:"simple-title-"+p.titlePosition}),Box.extend(m.style,{width:e+"px",paddingLeft:n+"px",paddingRight:n+"px"}),document.body.appendChild(m),p.titlePosition){case"over":m.style.bottom=n+"px";break;default:g=m.offsetHeight-p.padding,u.height+=g}i.appendChild(m),m.style.display="none"}(),s=u.width-2*p.padding,c=u.height-2*p.padding-g,"none"!=Box.getComputedStyleValue(i,"display"))return l.style.display="none",a.style.display="none",d.style.display="none",void Box.fadeOut(n,v,function(){if(n.style.overflow="hidden",n.innerHTML=t.innerHTML,(f={width:parseInt(n.style.width),height:parseInt(n.style.height)}).width==s&&f.height==c)Box.fadeIn(n,v,function(){Box.extendStyle(i,u),N()});else{f=y,new Animate(b,"fx",{from:0,to:1,time:p.changeSpeed,step:L,callback:function(e){Box.fadeIn(n,v,N)}})}});f=A(),n.innerHTML=t.innerHTML,p.overlayShow&&(e.style.backgroundColor=p.overlayColor,e.style.opacity=p.overlayOpacity,e.style.display="block"),"elastic"==p.transitionIn?(Box.extend(n.style,{top:p.padding+"px",left:p.padding+"px",width:Math.max(f.width-2*p.padding,1)+"px",height:Math.max(f.height-2*p.padding,1)+"px"}),Box.extendStyle(i,f),i.style.opacity=1,i.style.display="block",new Animate(b,"fx",{from:0,to:1,step:L,time:p.speedIn,callback:N})):(Box.extendStyle(i,u),Box.extend(n.style,{top:p.padding+"px",left:p.padding+"px",width:Math.max(u.width-2*p.padding,1)+"px",height:Math.max(u.height-2*p.padding-g,1)+"px"}),"fade"==p.transitionIn?Box.fadeIn(i,v,N):(i.style.opacity=1,i.style.display="block",N()))}function N(){var t=p.scrolling;t="auto"==t?"html"==p.type?"auto":"hidden":"yes"==t?"auto":"visible",n.style.overflow=t,m&&(m.style.display="block"),p.showCloseButton&&(l.style.display="block"),p.hideOnContentClick&&(Box.removeEvent(n,"click",O),Box.addEvent(n,"click",O)),p.hideOnOverlayClick&&p.overlayShow&&(Box.removeEvent(e,"click",O),Box.addEvent(e,"click",O)),h.length>1&&function(){var e=navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel";Box.addEvent(document,"keydown",q),p.enableMouseWheel&&(Box.removeEvent(i,e,F),Box.addEvent(i,e,F));if(!p.showNavArrows)return;(p.cyclic&&h.length>1||0!=r)&&(a.style.display="block");(p.cyclic&&h.length>1||r!=h.length-1)&&(d.style.display="block")}(),p.enableCenter&&Box.addEvent(window,"resize",W),y=!1,function(){var e,t,i,n,o=h.length;for(e=r+1,t=r+p.preloadIndent;e<=t&&!(e>o-1);++e)void 0!==(n=h[e].href)&&!k[e]&&n.match(B)&&((i=new Image).src=h[e].href,k[e]=i);for(e=t+1;e<o-1;++e)delete k[e];for(e=r-1,t=r-p.preloadIndent;e>=t&&!(e<0);e--)void 0!==(n=h[e].href)&&!k[e]&&n.match(B)&&((i=new Image).src=h[e].href,k[e]=i);for(e=0;e<t;++e)delete k[e]}()}function L(e){var t=Math.round(f.width+(u.width-f.width)*e),o=Math.round(f.height+(u.height-f.height)*e),l=Math.round(f.top+(u.top-f.top)*e),a=Math.round(f.left+(u.left-f.left)*e);Box.extendStyle(i,{width:t,height:o,left:a,top:l}),t=Math.max(t-2*p.padding,0),o=Math.max(o-(2*p.padding+g*e),0),n.style.width=t+"px",n.style.height=o+"px"}function D(){var e,t=(e=document.documentElement,{width:window.innerWidth||e&&e.clientWidth||document.body.clientWidth,height:window.innerHeight||e&&e.clientHeight||document.body.clientHeight});return[t.width,t.height,document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]}function A(){var e,t,i=p.orig,n=p.padding;return i?{width:(e=function(e){var t,i,n=0,o=0;t=e.offsetHeight,i=e.offsetWidth;do{o+=e.offsetLeft,n+=e.offsetTop}while(e=e.offsetParent);return{width:i,height:t,left:o,top:n}}(i)).width+2*n,height:e.height+2*n,top:e.top-n,left:e.left-n}:{width:1,height:1,top:(t=D())[3]+.5*t[1],left:t[2]+.5*t[0]}}function P(){var e=D(),t={},i=p.margin,n=p.autoScale,o=2*p.padding,l=2*(p.margin+w),a=2*(p.margin+w);if(p.width.toString().indexOf("%")>-1?(t.width=e[0]*parseFloat(p.width)/100-2*w,n=!1):t.width=p.width+o,p.height.toString().indexOf("%")>-1?(t.height=e[1]*parseFloat(p.height)/100-2*w,n=!1):t.height=p.height+o,n&&(t.width>e[0]-l||t.height>e[1]-a))if("image"==p.type){l+=o,a+=o;var d=Math.min(Math.min(e[0]-l,p.width)/p.width,Math.min(e[1]-a,p.height)/p.height);t.width=Math.round(d*(t.width-o))+o,t.height=Math.round(d*(t.height-o))+o}else t.width=Math.min(t.width,e[0]-l),t.height=Math.min(t.height,e[1]-a);return t.left=e[2]+.5*(e[0]-t.width),t.top=e[3]+.5*(e[1]-t.height),0==p.autoScale&&(t.top=Math.max(e[3]+i,t.top),t.left=Math.max(e[2]+i,t.left)),t}function F(e){((e=e||window.event).wheelDelta?e.wheelDelta/120:-e.detail/3)<0?V():j(),e.preventDefault()}function W(){console.log(D()),f=A(),u=P(),m&&(m.style.width=u.width-2*p.padding+"px","inside"==p.titlePosition&&(g=m.offsetHeight-p.padding,u.height+=g)),Box.extendStyle(i,u),Box.extend(n.style,{top:p.padding+"px",left:p.padding+"px",width:Math.max(u.width-2*p.padding,1)+"px",height:Math.max(u.height-2*p.padding-g,1)+"px"})}function q(e){e||window.event;27==e.keyCode&&p.enableEscapeButton?(e.preventDefault(),O()):37==e.keyCode?(e.preventDefault(),j()):39==e.keyCode&&(e.preventDefault(),V())}function j(){return z(r-1)}function V(){return z(r+1)}function z(e){y||(e>-1&&h.length>e&&(r=e,H()),p.cyclic&&h.length>1&&e<0&&(r=h.length-1,H()),p.cyclic&&h.length>1&&e>=h.length&&(r=0,H()))}function $(){"block"==o.style.display?(o.childNodes[0].style.top=-40*v+"px",v=(v+1)%12):clearInterval(c)}return{init:function(){var h=document.createDocumentFragment(),r=Box.createElement("div",{id:"simplebox"});h.appendChild(r),t=Box.createElement("div",{id:"simple-tmp"}),r.appendChild(t),(o=t.cloneNode(!1)).id="simple-loading",o.appendChild(document.createElement("div")),r.appendChild(o),(e=t.cloneNode(!1)).id="simple-overlay",r.appendChild(e),(i=t.cloneNode(!1)).id="simple-outer",r.appendChild(i),(n=t.cloneNode(!1)).id="simple-inner",i.appendChild(n),l=Box.createElement("a",{id:"simple-close"}),i.appendChild(l),a=Box.createElement("a",{id:"simple-left"});var s=Box.createElement("span",{id:"simple-left-ico",className:"simple-ico"});a.appendChild(s),i.appendChild(a),(d=a.cloneNode(!0)).id="simple-right",d.querySelector("span").id="simple-right-ico",i.appendChild(d),document.body.appendChild(h),Box.addEvent(l,"click",O),Box.addEvent(a,"click",j),Box.addEvent(d,"click",V),Box.addEvent(o,"click",S)},start:function(e,t,i){var n;if("string"==typeof e?(n=document.querySelectorAll(e),n=Array.prototype.slice.call(n,0)):n=!Array.isArray(e)&&[e],2==arguments.length&&"boolean"==typeof arguments[1]&&(i=t,t=null),0!=n.length){if(i)return e=n[0],void o(0,n);n.forEach(function(t,i,n){Box.addEvent(t,"click",function(l){e=t,l.preventDefault(),o(i,n)})})}function o(i,n){h=n,r=i,s=Box.extend({},M);var o,l,a=e.attributes;if(a)for(var d=0,p=a.length;d<p;++d)if(0==(o=a[d].nodeName).indexOf("data-")){l=(o=o.split("-")).pop();for(var c=1,f=o.length,u=s;c<f;++c)u[o[c]]&&(u=u[o[c]]);u[l]=a[d].nodeValue}t&&Box.extend(s,t),s.width=parseInt(s.width),s.height=parseInt(s.height),H()}}}}();